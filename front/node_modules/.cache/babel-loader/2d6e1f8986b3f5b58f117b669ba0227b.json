{"ast":null,"code":"'use strict';\n\nmodule.exports = Game_pong = {\n  start: function (id, game, cfg) {\n    return Object.construct(Game_pong.Runner, id, game, cfg).game;\n  },\n  addEvent: function (obj, type, fn) {\n    obj.addEventListener(type, fn, false);\n  },\n  removeEvent: function (obj, type, fn) {\n    obj.removeEventListener(type, fn, false);\n  },\n  random: function (min, max) {\n    return min + Math.random() * (max - min);\n  },\n  timestamp: function () {\n    return new Date().getTime();\n  },\n  Runner: {\n    initialize: function (id, game, cfg) {\n      this.cfg = Object.extend(game.Defaults || {}, cfg || {}); // use game defaults (if any) and extend with custom cfg (if any)\n\n      this.fps = this.cfg.fps || 60;\n      this.interval = 1000.0 / this.fps;\n      this.canvas = document.getElementById(id);\n      this.width = this.cfg.width || this.canvas.offsetWidth;\n      this.height = this.cfg.height || this.canvas.offsetHeight;\n      this.front = this.canvas;\n      this.front.width = this.width;\n      this.front.height = this.height;\n      this.back = Game_pong.createCanvas();\n      this.back.width = this.width;\n      this.back.height = this.height;\n      this.front2d = this.front.getContext('2d');\n      this.back2d = this.back.getContext('2d');\n      this.addEvents();\n      this.resetStats();\n      this.game = Object.construct(game, this, this.cfg); // finally construct the game object itself\n    },\n    start: function () {\n      this.lastFrame = Game_pong.timestamp();\n      this.timer = setInterval(this.loop.bind(this), this.interval);\n    },\n    stop: function () {\n      clearInterval(this.timer);\n    },\n    loop: function () {\n      var start = Game_pong.timestamp();\n      this.update((start - this.lastFrame) / 1000.0); // send dt as seconds\n\n      var middle = Game_pong.timestamp();\n      this.draw();\n      var end = Game_pong.timestamp();\n      this.updateStats(middle - start, end - middle);\n      this.lastFrame = start;\n    },\n    update: function (dt) {\n      this.game.update(dt);\n    },\n    draw: function () {\n      this.back2d.clearRect(0, 0, this.width, this.height);\n      this.game.draw(this.back2d);\n      this.drawStats(this.back2d);\n      this.front2d.clearRect(0, 0, this.width, this.height);\n      this.front2d.drawImage(this.back, 0, 0);\n    },\n    resetStats: function () {\n      this.stats = {\n        count: 0,\n        fps: 0,\n        update: 0,\n        draw: 0,\n        frame: 0 // update + draw\n\n      };\n    },\n    updateStats: function (update, draw) {\n      if (this.cfg.stats) {\n        this.stats.update = Math.max(1, update);\n        this.stats.draw = Math.max(1, draw);\n        this.stats.frame = this.stats.update + this.stats.draw;\n        this.stats.count = this.stats.count == this.fps ? 0 : this.stats.count + 1;\n        this.stats.fps = Math.min(this.fps, 1000 / this.stats.frame);\n      }\n    },\n    drawStats: function (ctx) {\n      if (this.cfg.stats) {\n        ctx.fillText(\"frame: \" + this.stats.count, this.width - 100, this.height - 60);\n        ctx.fillText(\"fps: \" + this.stats.fps, this.width - 100, this.height - 50);\n        ctx.fillText(\"update: \" + this.stats.update + \"ms\", this.width - 100, this.height - 40);\n        ctx.fillText(\"draw: \" + this.stats.draw + \"ms\", this.width - 100, this.height - 30);\n      }\n    },\n    addEvents: function () {\n      Game_pong.addEvent(document, 'keydown', this.onkeydown.bind(this));\n      Game_pong.addEvent(document, 'keyup', this.onkeyup.bind(this));\n    },\n    onkeydown: function (ev) {\n      if (this.game.onkeydown) this.game.onkeydown(ev.keyCode);\n    },\n    onkeyup: function (ev) {\n      if (this.game.onkeyup) this.game.onkeyup(ev.keyCode);\n    },\n    hideCursor: function () {\n      this.canvas.style.cursor = 'none';\n    },\n    showCursor: function () {\n      this.canvas.style.cursor = 'auto';\n    },\n    alert: function (msg) {\n      this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n\n      result = window.alert(msg);\n      this.start();\n      return result;\n    },\n    confirm: function (msg) {\n      this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n\n      result = window.confirm(msg);\n      this.start();\n      return result;\n    }\n  }\n};","map":{"version":3,"sources":["/Users/art/Desktop/transcendence/transcendence/transcendence/src/game/game.js"],"names":["module","exports","Game_pong","start","id","game","cfg","Object","construct","Runner","addEvent","obj","type","fn","addEventListener","removeEvent","removeEventListener","random","min","max","Math","timestamp","Date","getTime","initialize","extend","Defaults","fps","interval","canvas","document","getElementById","width","offsetWidth","height","offsetHeight","front","back","createCanvas","front2d","getContext","back2d","addEvents","resetStats","lastFrame","timer","setInterval","loop","bind","stop","clearInterval","update","middle","draw","end","updateStats","dt","clearRect","drawStats","drawImage","stats","count","frame","ctx","fillText","onkeydown","onkeyup","ev","keyCode","hideCursor","style","cursor","showCursor","alert","msg","result","window","confirm"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,OAAP,GAAiBC,SAAS,GAAG;AACzBC,EAAAA,KAAK,EAAE,UAASC,EAAT,EAAaC,IAAb,EAAmBC,GAAnB,EAAwB;AAC3B,WAAOC,MAAM,CAACC,SAAP,CAAiBN,SAAS,CAACO,MAA3B,EAAmCL,EAAnC,EAAuCC,IAAvC,EAA6CC,GAA7C,EAAkDD,IAAzD;AACH,GAHwB;AAIzBK,EAAAA,QAAQ,EAAK,UAASC,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAwB;AAAEF,IAAAA,GAAG,CAACG,gBAAJ,CAAqBF,IAArB,EAA2BC,EAA3B,EAA+B,KAA/B;AAA2C,GAJzD;AAKzBE,EAAAA,WAAW,EAAE,UAASJ,GAAT,EAAcC,IAAd,EAAoBC,EAApB,EAAwB;AAAEF,IAAAA,GAAG,CAACK,mBAAJ,CAAwBJ,IAAxB,EAA8BC,EAA9B,EAAkC,KAAlC;AAA2C,GALzD;AAMzBI,EAAAA,MAAM,EAAE,UAASC,GAAT,EAAcC,GAAd,EAAmB;AACvB,WAAQD,GAAG,GAAIE,IAAI,CAACH,MAAL,MAAiBE,GAAG,GAAGD,GAAvB,CAAf;AACH,GARwB;AASzBG,EAAAA,SAAS,EAAE,YAAW;AAClB,WAAO,IAAIC,IAAJ,GAAWC,OAAX,EAAP;AACH,GAXwB;AAYzBd,EAAAA,MAAM,EAAE;AAEJe,IAAAA,UAAU,EAAE,UAASpB,EAAT,EAAaC,IAAb,EAAmBC,GAAnB,EAAwB;AAClC,WAAKA,GAAL,GAAoBC,MAAM,CAACkB,MAAP,CAAcpB,IAAI,CAACqB,QAAL,IAAiB,EAA/B,EAAmCpB,GAAG,IAAI,EAA1C,CAApB,CADkC,CACiC;;AACnE,WAAKqB,GAAL,GAAoB,KAAKrB,GAAL,CAASqB,GAAT,IAAgB,EAApC;AACA,WAAKC,QAAL,GAAoB,SAAS,KAAKD,GAAlC;AACA,WAAKE,MAAL,GAAoBC,QAAQ,CAACC,cAAT,CAAwB3B,EAAxB,CAApB;AACA,WAAK4B,KAAL,GAAoB,KAAK1B,GAAL,CAAS0B,KAAT,IAAmB,KAAKH,MAAL,CAAYI,WAAnD;AACA,WAAKC,MAAL,GAAoB,KAAK5B,GAAL,CAAS4B,MAAT,IAAmB,KAAKL,MAAL,CAAYM,YAAnD;AACA,WAAKC,KAAL,GAAoB,KAAKP,MAAzB;AACA,WAAKO,KAAL,CAAWJ,KAAX,GAAoB,KAAKA,KAAzB;AACA,WAAKI,KAAL,CAAWF,MAAX,GAAoB,KAAKA,MAAzB;AACA,WAAKG,IAAL,GAAoBnC,SAAS,CAACoC,YAAV,EAApB;AACA,WAAKD,IAAL,CAAUL,KAAV,GAAoB,KAAKA,KAAzB;AACA,WAAKK,IAAL,CAAUH,MAAV,GAAoB,KAAKA,MAAzB;AACA,WAAKK,OAAL,GAAoB,KAAKH,KAAL,CAAWI,UAAX,CAAsB,IAAtB,CAApB;AACA,WAAKC,MAAL,GAAoB,KAAKJ,IAAL,CAAUG,UAAV,CAAqB,IAArB,CAApB;AACA,WAAKE,SAAL;AACA,WAAKC,UAAL;AAEA,WAAKtC,IAAL,GAAYE,MAAM,CAACC,SAAP,CAAiBH,IAAjB,EAAuB,IAAvB,EAA6B,KAAKC,GAAlC,CAAZ,CAlBkC,CAkBkB;AACrD,KArBG;AAuBJH,IAAAA,KAAK,EAAE,YAAW;AACd,WAAKyC,SAAL,GAAiB1C,SAAS,CAACmB,SAAV,EAAjB;AACA,WAAKwB,KAAL,GAAiBC,WAAW,CAAC,KAAKC,IAAL,CAAUC,IAAV,CAAe,IAAf,CAAD,EAAuB,KAAKpB,QAA5B,CAA5B;AACD,KA1BC;AA4BJqB,IAAAA,IAAI,EAAE,YAAW;AACbC,MAAAA,aAAa,CAAC,KAAKL,KAAN,CAAb;AACH,KA9BG;AAgCJE,IAAAA,IAAI,EAAE,YAAW;AACb,UAAI5C,KAAK,GAAID,SAAS,CAACmB,SAAV,EAAb;AAAoC,WAAK8B,MAAL,CAAY,CAAChD,KAAK,GAAG,KAAKyC,SAAd,IAAyB,MAArC,EADvB,CACqE;;AAClF,UAAIQ,MAAM,GAAGlD,SAAS,CAACmB,SAAV,EAAb;AAAoC,WAAKgC,IAAL;AACpC,UAAIC,GAAG,GAAMpD,SAAS,CAACmB,SAAV,EAAb;AACA,WAAKkC,WAAL,CAAiBH,MAAM,GAAGjD,KAA1B,EAAiCmD,GAAG,GAAGF,MAAvC;AACA,WAAKR,SAAL,GAAiBzC,KAAjB;AACD,KAtCC;AAwCFgD,IAAAA,MAAM,EAAE,UAASK,EAAT,EAAa;AACnB,WAAKnD,IAAL,CAAU8C,MAAV,CAAiBK,EAAjB;AACD,KA1CC;AA4CFH,IAAAA,IAAI,EAAE,YAAW;AACf,WAAKZ,MAAL,CAAYgB,SAAZ,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,KAAKzB,KAAjC,EAAwC,KAAKE,MAA7C;AACA,WAAK7B,IAAL,CAAUgD,IAAV,CAAe,KAAKZ,MAApB;AACA,WAAKiB,SAAL,CAAe,KAAKjB,MAApB;AACA,WAAKF,OAAL,CAAakB,SAAb,CAAuB,CAAvB,EAA0B,CAA1B,EAA6B,KAAKzB,KAAlC,EAAyC,KAAKE,MAA9C;AACA,WAAKK,OAAL,CAAaoB,SAAb,CAAuB,KAAKtB,IAA5B,EAAkC,CAAlC,EAAqC,CAArC;AACD,KAlDC;AAoDFM,IAAAA,UAAU,EAAE,YAAW;AACrB,WAAKiB,KAAL,GAAa;AACXC,QAAAA,KAAK,EAAG,CADG;AAEXlC,QAAAA,GAAG,EAAK,CAFG;AAGXwB,QAAAA,MAAM,EAAE,CAHG;AAIXE,QAAAA,IAAI,EAAI,CAJG;AAKXS,QAAAA,KAAK,EAAG,CALG,CAKA;;AALA,OAAb;AAOD,KA5DC;AA8DFP,IAAAA,WAAW,EAAE,UAASJ,MAAT,EAAiBE,IAAjB,EAAuB;AAClC,UAAI,KAAK/C,GAAL,CAASsD,KAAb,EAAoB;AAClB,aAAKA,KAAL,CAAWT,MAAX,GAAoB/B,IAAI,CAACD,GAAL,CAAS,CAAT,EAAYgC,MAAZ,CAApB;AACA,aAAKS,KAAL,CAAWP,IAAX,GAAoBjC,IAAI,CAACD,GAAL,CAAS,CAAT,EAAYkC,IAAZ,CAApB;AACA,aAAKO,KAAL,CAAWE,KAAX,GAAoB,KAAKF,KAAL,CAAWT,MAAX,GAAoB,KAAKS,KAAL,CAAWP,IAAnD;AACA,aAAKO,KAAL,CAAWC,KAAX,GAAoB,KAAKD,KAAL,CAAWC,KAAX,IAAoB,KAAKlC,GAAzB,GAA+B,CAA/B,GAAmC,KAAKiC,KAAL,CAAWC,KAAX,GAAmB,CAA1E;AACA,aAAKD,KAAL,CAAWjC,GAAX,GAAoBP,IAAI,CAACF,GAAL,CAAS,KAAKS,GAAd,EAAmB,OAAO,KAAKiC,KAAL,CAAWE,KAArC,CAApB;AACD;AACF,KAtEC;AAwEFJ,IAAAA,SAAS,EAAE,UAASK,GAAT,EAAc;AACvB,UAAI,KAAKzD,GAAL,CAASsD,KAAb,EAAoB;AAClBG,QAAAA,GAAG,CAACC,QAAJ,CAAa,YAAa,KAAKJ,KAAL,CAAWC,KAArC,EAAoD,KAAK7B,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACA6B,QAAAA,GAAG,CAACC,QAAJ,CAAa,UAAa,KAAKJ,KAAL,CAAWjC,GAArC,EAAoD,KAAKK,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACA6B,QAAAA,GAAG,CAACC,QAAJ,CAAa,aAAa,KAAKJ,KAAL,CAAWT,MAAxB,GAAiC,IAA9C,EAAoD,KAAKnB,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACA6B,QAAAA,GAAG,CAACC,QAAJ,CAAa,WAAa,KAAKJ,KAAL,CAAWP,IAAxB,GAAiC,IAA9C,EAAoD,KAAKrB,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACD;AACF,KA/EC;AAiFFQ,IAAAA,SAAS,EAAE,YAAW;AACpBxC,MAAAA,SAAS,CAACQ,QAAV,CAAmBoB,QAAnB,EAA6B,SAA7B,EAAwC,KAAKmC,SAAL,CAAejB,IAAf,CAAoB,IAApB,CAAxC;AACA9C,MAAAA,SAAS,CAACQ,QAAV,CAAmBoB,QAAnB,EAA6B,OAA7B,EAAwC,KAAKoC,OAAL,CAAalB,IAAb,CAAkB,IAAlB,CAAxC;AACD,KApFC;AAsFFiB,IAAAA,SAAS,EAAE,UAASE,EAAT,EAAa;AAAE,UAAI,KAAK9D,IAAL,CAAU4D,SAAd,EAAyB,KAAK5D,IAAL,CAAU4D,SAAV,CAAoBE,EAAE,CAACC,OAAvB;AAAkC,KAtFnF;AAuFFF,IAAAA,OAAO,EAAI,UAASC,EAAT,EAAa;AAAE,UAAI,KAAK9D,IAAL,CAAU6D,OAAd,EAAyB,KAAK7D,IAAL,CAAU6D,OAAV,CAAkBC,EAAE,CAACC,OAArB;AAAkC,KAvFnF;AAyFFC,IAAAA,UAAU,EAAE,YAAW;AAAE,WAAKxC,MAAL,CAAYyC,KAAZ,CAAkBC,MAAlB,GAA2B,MAA3B;AAAoC,KAzF3D;AA0FFC,IAAAA,UAAU,EAAE,YAAW;AAAE,WAAK3C,MAAL,CAAYyC,KAAZ,CAAkBC,MAAlB,GAA2B,MAA3B;AAAoC,KA1F3D;AA4FFE,IAAAA,KAAK,EAAE,UAASC,GAAT,EAAc;AACnB,WAAKzB,IAAL,GADmB,CACN;;AACb0B,MAAAA,MAAM,GAAGC,MAAM,CAACH,KAAP,CAAaC,GAAb,CAAT;AACA,WAAKvE,KAAL;AACA,aAAOwE,MAAP;AACD,KAjGC;AAmGFE,IAAAA,OAAO,EAAE,UAASH,GAAT,EAAc;AACrB,WAAKzB,IAAL,GADqB,CACR;;AACb0B,MAAAA,MAAM,GAAGC,MAAM,CAACC,OAAP,CAAeH,GAAf,CAAT;AACA,WAAKvE,KAAL;AACA,aAAOwE,MAAP;AACD;AAxGC;AAZiB,CAA7B","sourcesContent":["'use strict';\n\nmodule.exports = Game_pong = {\n    start: function(id, game, cfg) {\n        return Object.construct(Game_pong.Runner, id, game, cfg).game;\n    },\n    addEvent:    function(obj, type, fn) { obj.addEventListener(type, fn, false);    },\n    removeEvent: function(obj, type, fn) { obj.removeEventListener(type, fn, false); },\n    random: function(min, max) {\n        return (min + (Math.random() * (max - min)));\n    },\n    timestamp: function() { \n        return new Date().getTime();\n    },\n    Runner: {\n\n        initialize: function(id, game, cfg) {\n          this.cfg          = Object.extend(game.Defaults || {}, cfg || {}); // use game defaults (if any) and extend with custom cfg (if any)\n          this.fps          = this.cfg.fps || 60;\n          this.interval     = 1000.0 / this.fps;\n          this.canvas       = document.getElementById(id);\n          this.width        = this.cfg.width  || this.canvas.offsetWidth;\n          this.height       = this.cfg.height || this.canvas.offsetHeight;\n          this.front        = this.canvas;\n          this.front.width  = this.width;\n          this.front.height = this.height;\n          this.back         = Game_pong.createCanvas();\n          this.back.width   = this.width;\n          this.back.height  = this.height;\n          this.front2d      = this.front.getContext('2d');\n          this.back2d       = this.back.getContext('2d');\n          this.addEvents();\n          this.resetStats();\n    \n          this.game = Object.construct(game, this, this.cfg); // finally construct the game object itself\n        },\n\n        start: function() { \n            this.lastFrame = Game_pong.timestamp();\n            this.timer     = setInterval(this.loop.bind(this), this.interval);\n          },\n\n        stop: function() {\n            clearInterval(this.timer);\n        },\n\n        loop: function() {\n            var start  = Game_pong.timestamp(); this.update((start - this.lastFrame)/1000.0); // send dt as seconds\n            var middle = Game_pong.timestamp(); this.draw();\n            var end    = Game_pong.timestamp();\n            this.updateStats(middle - start, end - middle);\n            this.lastFrame = start;\n          },\n      \n          update: function(dt) {\n            this.game.update(dt);\n          },\n      \n          draw: function() {\n            this.back2d.clearRect(0, 0, this.width, this.height);\n            this.game.draw(this.back2d);\n            this.drawStats(this.back2d);\n            this.front2d.clearRect(0, 0, this.width, this.height);\n            this.front2d.drawImage(this.back, 0, 0);\n          },\n      \n          resetStats: function() {\n            this.stats = {\n              count:  0,\n              fps:    0,\n              update: 0,\n              draw:   0, \n              frame:  0  // update + draw\n            };\n          },\n      \n          updateStats: function(update, draw) {\n            if (this.cfg.stats) {\n              this.stats.update = Math.max(1, update);\n              this.stats.draw   = Math.max(1, draw);\n              this.stats.frame  = this.stats.update + this.stats.draw;\n              this.stats.count  = this.stats.count == this.fps ? 0 : this.stats.count + 1;\n              this.stats.fps    = Math.min(this.fps, 1000 / this.stats.frame);\n            }\n          },\n      \n          drawStats: function(ctx) {\n            if (this.cfg.stats) {\n              ctx.fillText(\"frame: \"  + this.stats.count,         this.width - 100, this.height - 60);\n              ctx.fillText(\"fps: \"    + this.stats.fps,           this.width - 100, this.height - 50);\n              ctx.fillText(\"update: \" + this.stats.update + \"ms\", this.width - 100, this.height - 40);\n              ctx.fillText(\"draw: \"   + this.stats.draw   + \"ms\", this.width - 100, this.height - 30);\n            }\n          },\n      \n          addEvents: function() {\n            Game_pong.addEvent(document, 'keydown', this.onkeydown.bind(this));\n            Game_pong.addEvent(document, 'keyup',   this.onkeyup.bind(this));\n          },\n      \n          onkeydown: function(ev) { if (this.game.onkeydown) this.game.onkeydown(ev.keyCode); },\n          onkeyup:   function(ev) { if (this.game.onkeyup)   this.game.onkeyup(ev.keyCode);   },\n      \n          hideCursor: function() { this.canvas.style.cursor = 'none'; },\n          showCursor: function() { this.canvas.style.cursor = 'auto'; },\n      \n          alert: function(msg) {\n            this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n            result = window.alert(msg);\n            this.start();\n            return result;\n          },\n      \n          confirm: function(msg) {\n            this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n            result = window.confirm(msg);\n            this.start();\n            return result;\n          }      \n    }\n}"]},"metadata":{},"sourceType":"module"}