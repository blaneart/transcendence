{"ast":null,"code":"//=============================================================================\n//\n// We need some ECMAScript 5 methods but we need to implement them ourselves\n// for older browsers (compatibility: http://kangax.github.com/es5-compat-table/)\n//\n//  Function.bind:        https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind\n//  Object.create:        http://javascript.crockford.com/prototypal.html\n//  Object.extend:        (defacto standard like jquery $.extend or prototype's Object.extend)\n//\n//  Object.construct:     our own wrapper around Object.create that ALSO calls\n//                        an initialize constructor method if one exists\n//\n//=============================================================================\nif (!Function.prototype.bind) {\n  Function.prototype.bind = function (obj) {\n    var slice = [].slice,\n        args = slice.call(arguments, 1),\n        self = this,\n        nop = function () {},\n        bound = function () {\n      return self.apply(this instanceof nop ? this : obj || {}, args.concat(slice.call(arguments)));\n    };\n\n    nop.prototype = self.prototype;\n    bound.prototype = new nop();\n    return bound;\n  };\n}\n\nif (!Object.create) {\n  Object.create = function (base) {\n    function F() {}\n\n    ;\n    F.prototype = base;\n    return new F();\n  };\n}\n\nif (!Object.construct) {\n  Object.construct = function (base) {\n    var instance = Object.create(base);\n    if (instance.initialize) instance.initialize.apply(instance, [].slice.call(arguments, 1));\n    return instance;\n  };\n}\n\nif (!Object.extend) {\n  Object.extend = function (destination, source) {\n    for (var property in source) {\n      if (source.hasOwnProperty(property)) destination[property] = source[property];\n    }\n\n    return destination;\n  };\n}\n/* NOT READY FOR PRIME TIME\nif (!window.requestAnimationFrame) {// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n  window.requestAnimationFrame = window.webkitRequestAnimationFrame || \n                                 window.mozRequestAnimationFrame    || \n                                 window.oRequestAnimationFrame      || \n                                 window.msRequestAnimationFrame     || \n                                 function(callback, element) {\n                                   window.setTimeout(callback, 1000 / 60);\n                                 }\n}\n*/\n//=============================================================================\n// GAME\n//=============================================================================\n\n\nGame = {\n  compatible: function () {\n    return Object.create && Object.extend && Function.bind && document.addEventListener && // HTML5 standard, all modern browsers that support canvas should also support add/removeEventListener\n    Game.ua.hasCanvas;\n  },\n  start: function (id, game, cfg) {\n    if (Game.compatible()) return Object.construct(Game.Runner, id, game, cfg).game; // return the game instance, not the runner (caller can always get at the runner via game.runner)\n  },\n  ua: function () {\n    // should avoid user agent sniffing... but sometimes you just gotta do what you gotta do\n    var ua = navigator.userAgent.toLowerCase();\n    var key = ua.indexOf(\"opera\") > -1 ? \"opera\" : null;\n    key = key || (ua.indexOf(\"firefox\") > -1 ? \"firefox\" : null);\n    key = key || (ua.indexOf(\"chrome\") > -1 ? \"chrome\" : null);\n    key = key || (ua.indexOf(\"safari\") > -1 ? \"safari\" : null);\n    key = key || (ua.indexOf(\"msie\") > -1 ? \"ie\" : null);\n\n    try {\n      var re = key == \"ie\" ? \"msie (\\\\d)\" : key + \"\\\\/(\\\\d\\\\.\\\\d)\";\n      var matches = ua.match(new RegExp(re, \"i\"));\n      var version = matches ? parseFloat(matches[1]) : null;\n    } catch (e) {}\n\n    return {\n      full: ua,\n      name: key + (version ? \" \" + version.toString() : \"\"),\n      version: version,\n      isFirefox: key == \"firefox\",\n      isChrome: key == \"chrome\",\n      isSafari: key == \"safari\",\n      isOpera: key == \"opera\",\n      isIE: key == \"ie\",\n      hasCanvas: document.createElement('canvas').getContext,\n      hasAudio: typeof Audio != 'undefined'\n    };\n  }(),\n  addEvent: function (obj, type, fn) {\n    obj.addEventListener(type, fn, false);\n  },\n  removeEvent: function (obj, type, fn) {\n    obj.removeEventListener(type, fn, false);\n  },\n  ready: function (fn) {\n    if (Game.compatible()) Game.addEvent(document, 'DOMContentLoaded', fn);\n  },\n  createCanvas: function () {\n    return document.createElement('canvas');\n  },\n  createAudio: function (src) {\n    try {\n      var a = new Audio(src);\n      a.volume = 0.1; // lets be real quiet please\n\n      return a;\n    } catch (e) {\n      return null;\n    }\n  },\n  loadImages: function (sources, callback) {\n    /* load multiple images and callback when ALL have finished loading */\n    var images = {};\n    var count = sources ? sources.length : 0;\n\n    if (count == 0) {\n      callback(images);\n    } else {\n      for (var n = 0; n < sources.length; n++) {\n        var source = sources[n];\n        var image = document.createElement('img');\n        images[source] = image;\n        Game.addEvent(image, 'load', function () {\n          if (--count == 0) callback(images);\n        });\n        image.src = source;\n      }\n    }\n  },\n  random: function (min, max) {\n    return min + Math.random() * (max - min);\n  },\n  timestamp: function () {\n    return new Date().getTime();\n  },\n  KEY: {\n    BACKSPACE: 8,\n    TAB: 9,\n    RETURN: 13,\n    ESC: 27,\n    SPACE: 32,\n    LEFT: 37,\n    UP: 38,\n    RIGHT: 39,\n    DOWN: 40,\n    DELETE: 46,\n    HOME: 36,\n    END: 35,\n    PAGEUP: 33,\n    PAGEDOWN: 34,\n    INSERT: 45,\n    ZERO: 48,\n    ONE: 49,\n    TWO: 50,\n    A: 65,\n    L: 76,\n    P: 80,\n    Q: 81,\n    TILDA: 192\n  },\n  //-----------------------------------------------------------------------------\n  Runner: {\n    initialize: function (id, game, cfg) {\n      this.cfg = Object.extend(game.Defaults || {}, cfg || {}); // use game defaults (if any) and extend with custom cfg (if any)\n\n      this.fps = this.cfg.fps || 60;\n      this.interval = 1000.0 / this.fps;\n      this.canvas = document.getElementById(id);\n      this.width = this.cfg.width || this.canvas.offsetWidth;\n      this.height = this.cfg.height || this.canvas.offsetHeight;\n      this.front = this.canvas;\n      this.front.width = this.width;\n      this.front.height = this.height;\n      this.back = Game.createCanvas();\n      this.back.width = this.width;\n      this.back.height = this.height;\n      this.front2d = this.front.getContext('2d');\n      this.back2d = this.back.getContext('2d');\n      this.addEvents();\n      this.resetStats();\n      this.game = Object.construct(game, this, this.cfg); // finally construct the game object itself\n    },\n    start: function () {\n      // game instance should call runner.start() when its finished initializing and is ready to start the game loop\n      this.lastFrame = Game.timestamp();\n      this.timer = setInterval(this.loop.bind(this), this.interval);\n    },\n    stop: function () {\n      clearInterval(this.timer);\n    },\n    loop: function () {\n      var start = Game.timestamp();\n      this.update((start - this.lastFrame) / 1000.0); // send dt as seconds\n\n      var middle = Game.timestamp();\n      this.draw();\n      var end = Game.timestamp();\n      this.updateStats(middle - start, end - middle);\n      this.lastFrame = start;\n    },\n    update: function (dt) {\n      this.game.update(dt);\n    },\n    draw: function () {\n      this.back2d.clearRect(0, 0, this.width, this.height);\n      this.game.draw(this.back2d);\n      this.drawStats(this.back2d);\n      this.front2d.clearRect(0, 0, this.width, this.height);\n      this.front2d.drawImage(this.back, 0, 0);\n    },\n    resetStats: function () {\n      this.stats = {\n        count: 0,\n        fps: 0,\n        update: 0,\n        draw: 0,\n        frame: 0 // update + draw\n\n      };\n    },\n    updateStats: function (update, draw) {\n      if (this.cfg.stats) {\n        this.stats.update = Math.max(1, update);\n        this.stats.draw = Math.max(1, draw);\n        this.stats.frame = this.stats.update + this.stats.draw;\n        this.stats.count = this.stats.count == this.fps ? 0 : this.stats.count + 1;\n        this.stats.fps = Math.min(this.fps, 1000 / this.stats.frame);\n      }\n    },\n    drawStats: function (ctx) {\n      if (this.cfg.stats) {\n        ctx.fillText(\"frame: \" + this.stats.count, this.width - 100, this.height - 60);\n        ctx.fillText(\"fps: \" + this.stats.fps, this.width - 100, this.height - 50);\n        ctx.fillText(\"update: \" + this.stats.update + \"ms\", this.width - 100, this.height - 40);\n        ctx.fillText(\"draw: \" + this.stats.draw + \"ms\", this.width - 100, this.height - 30);\n      }\n    },\n    addEvents: function () {\n      Game.addEvent(document, 'keydown', this.onkeydown.bind(this));\n      Game.addEvent(document, 'keyup', this.onkeyup.bind(this));\n    },\n    onkeydown: function (ev) {\n      if (this.game.onkeydown) this.game.onkeydown(ev.keyCode);\n    },\n    onkeyup: function (ev) {\n      if (this.game.onkeyup) this.game.onkeyup(ev.keyCode);\n    },\n    hideCursor: function () {\n      this.canvas.style.cursor = 'none';\n    },\n    showCursor: function () {\n      this.canvas.style.cursor = 'auto';\n    },\n    alert: function (msg) {\n      this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n\n      result = window.alert(msg);\n      this.start();\n      return result;\n    },\n    confirm: function (msg) {\n      this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n\n      result = window.confirm(msg);\n      this.start();\n      return result;\n    } //-------------------------------------------------------------------------\n\n  } // Game.Runner\n\n}; // Game","map":{"version":3,"sources":["/Users/art/Desktop/transcendence/transcendence/transcendence/src/game/game.js"],"names":["Function","prototype","bind","obj","slice","args","call","arguments","self","nop","bound","apply","concat","Object","create","base","F","construct","instance","initialize","extend","destination","source","property","hasOwnProperty","Game","compatible","document","addEventListener","ua","hasCanvas","start","id","game","cfg","Runner","navigator","userAgent","toLowerCase","key","indexOf","re","matches","match","RegExp","version","parseFloat","e","full","name","toString","isFirefox","isChrome","isSafari","isOpera","isIE","createElement","getContext","hasAudio","Audio","addEvent","type","fn","removeEvent","removeEventListener","ready","createCanvas","createAudio","src","a","volume","loadImages","sources","callback","images","count","length","n","image","random","min","max","Math","timestamp","Date","getTime","KEY","BACKSPACE","TAB","RETURN","ESC","SPACE","LEFT","UP","RIGHT","DOWN","DELETE","HOME","END","PAGEUP","PAGEDOWN","INSERT","ZERO","ONE","TWO","A","L","P","Q","TILDA","Defaults","fps","interval","canvas","getElementById","width","offsetWidth","height","offsetHeight","front","back","front2d","back2d","addEvents","resetStats","lastFrame","timer","setInterval","loop","stop","clearInterval","update","middle","draw","end","updateStats","dt","clearRect","drawStats","drawImage","stats","frame","ctx","fillText","onkeydown","onkeyup","ev","keyCode","hideCursor","style","cursor","showCursor","alert","msg","result","window","confirm"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA,IAAI,CAACA,QAAQ,CAACC,SAAT,CAAmBC,IAAxB,EAA8B;AAC1BF,EAAAA,QAAQ,CAACC,SAAT,CAAmBC,IAAnB,GAA0B,UAASC,GAAT,EAAc;AACtC,QAAIC,KAAK,GAAG,GAAGA,KAAf;AAAA,QACIC,IAAI,GAAID,KAAK,CAACE,IAAN,CAAWC,SAAX,EAAsB,CAAtB,CADZ;AAAA,QAEIC,IAAI,GAAI,IAFZ;AAAA,QAGIC,GAAG,GAAK,YAAY,CAAE,CAH1B;AAAA,QAIIC,KAAK,GAAG,YAAY;AAClB,aAAOF,IAAI,CAACG,KAAL,CAAW,gBAAgBF,GAAhB,GAAsB,IAAtB,GAA8BN,GAAG,IAAI,EAAhD,EAAqDE,IAAI,CAACO,MAAL,CAAYR,KAAK,CAACE,IAAN,CAAWC,SAAX,CAAZ,CAArD,CAAP;AACD,KANL;;AAOAE,IAAAA,GAAG,CAACR,SAAJ,GAAkBO,IAAI,CAACP,SAAvB;AACAS,IAAAA,KAAK,CAACT,SAAN,GAAkB,IAAIQ,GAAJ,EAAlB;AACA,WAAOC,KAAP;AACD,GAXD;AAYD;;AAED,IAAI,CAACG,MAAM,CAACC,MAAZ,EAAoB;AAClBD,EAAAA,MAAM,CAACC,MAAP,GAAgB,UAASC,IAAT,EAAe;AAC7B,aAASC,CAAT,GAAa,CAAE;;AAAA;AACfA,IAAAA,CAAC,CAACf,SAAF,GAAcc,IAAd;AACA,WAAO,IAAIC,CAAJ,EAAP;AACD,GAJD;AAKD;;AAED,IAAI,CAACH,MAAM,CAACI,SAAZ,EAAuB;AACrBJ,EAAAA,MAAM,CAACI,SAAP,GAAmB,UAASF,IAAT,EAAe;AAChC,QAAIG,QAAQ,GAAGL,MAAM,CAACC,MAAP,CAAcC,IAAd,CAAf;AACA,QAAIG,QAAQ,CAACC,UAAb,EACED,QAAQ,CAACC,UAAT,CAAoBR,KAApB,CAA0BO,QAA1B,EAAoC,GAAGd,KAAH,CAASE,IAAT,CAAcC,SAAd,EAAyB,CAAzB,CAApC;AACF,WAAOW,QAAP;AACD,GALD;AAMD;;AAED,IAAI,CAACL,MAAM,CAACO,MAAZ,EAAoB;AAClBP,EAAAA,MAAM,CAACO,MAAP,GAAgB,UAASC,WAAT,EAAsBC,MAAtB,EAA8B;AAC5C,SAAK,IAAIC,QAAT,IAAqBD,MAArB,EAA6B;AAC3B,UAAIA,MAAM,CAACE,cAAP,CAAsBD,QAAtB,CAAJ,EACEF,WAAW,CAACE,QAAD,CAAX,GAAwBD,MAAM,CAACC,QAAD,CAA9B;AACH;;AACD,WAAOF,WAAP;AACD,GAND;AAOD;AAED;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEE;AACA;AACA;;;AAEFI,IAAI,GAAG;AAEHC,EAAAA,UAAU,EAAE,YAAW;AACrB,WAAOb,MAAM,CAACC,MAAP,IACAD,MAAM,CAACO,MADP,IAEApB,QAAQ,CAACE,IAFT,IAGAyB,QAAQ,CAACC,gBAHT,IAG6B;AAC7BH,IAAAA,IAAI,CAACI,EAAL,CAAQC,SAJf;AAKD,GARE;AAUHC,EAAAA,KAAK,EAAE,UAASC,EAAT,EAAaC,IAAb,EAAmBC,GAAnB,EAAwB;AAC7B,QAAIT,IAAI,CAACC,UAAL,EAAJ,EACE,OAAOb,MAAM,CAACI,SAAP,CAAiBQ,IAAI,CAACU,MAAtB,EAA8BH,EAA9B,EAAkCC,IAAlC,EAAwCC,GAAxC,EAA6CD,IAApD,CAF2B,CAE+B;AAC7D,GAbE;AAeHJ,EAAAA,EAAE,EAAE,YAAW;AAAE;AACf,QAAIA,EAAE,GAAIO,SAAS,CAACC,SAAV,CAAoBC,WAApB,EAAV;AACA,QAAIC,GAAG,GAAYV,EAAE,CAACW,OAAH,CAAW,OAAX,IAAwB,CAAC,CAA1B,GAA+B,OAA/B,GAA2C,IAA7D;AACID,IAAAA,GAAG,GAAGA,GAAG,KAAMV,EAAE,CAACW,OAAH,CAAW,SAAX,IAAwB,CAAC,CAA1B,GAA+B,SAA/B,GAA2C,IAAhD,CAAT;AACAD,IAAAA,GAAG,GAAGA,GAAG,KAAMV,EAAE,CAACW,OAAH,CAAW,QAAX,IAAwB,CAAC,CAA1B,GAA+B,QAA/B,GAA2C,IAAhD,CAAT;AACAD,IAAAA,GAAG,GAAGA,GAAG,KAAMV,EAAE,CAACW,OAAH,CAAW,QAAX,IAAwB,CAAC,CAA1B,GAA+B,QAA/B,GAA2C,IAAhD,CAAT;AACAD,IAAAA,GAAG,GAAGA,GAAG,KAAMV,EAAE,CAACW,OAAH,CAAW,MAAX,IAAwB,CAAC,CAA1B,GAA+B,IAA/B,GAA2C,IAAhD,CAAT;;AAEJ,QAAI;AACF,UAAIC,EAAE,GAASF,GAAG,IAAI,IAAR,GAAgB,YAAhB,GAA+BA,GAAG,GAAG,gBAAnD;AACA,UAAIG,OAAO,GAAGb,EAAE,CAACc,KAAH,CAAS,IAAIC,MAAJ,CAAWH,EAAX,EAAe,GAAf,CAAT,CAAd;AACA,UAAII,OAAO,GAAGH,OAAO,GAAGI,UAAU,CAACJ,OAAO,CAAC,CAAD,CAAR,CAAb,GAA4B,IAAjD;AACD,KAJD,CAIE,OAAOK,CAAP,EAAU,CAAE;;AAEd,WAAO;AACLC,MAAAA,IAAI,EAAOnB,EADN;AAELoB,MAAAA,IAAI,EAAOV,GAAG,IAAIM,OAAO,GAAG,MAAMA,OAAO,CAACK,QAAR,EAAT,GAA8B,EAAzC,CAFT;AAGLL,MAAAA,OAAO,EAAIA,OAHN;AAILM,MAAAA,SAAS,EAAGZ,GAAG,IAAI,SAJd;AAKLa,MAAAA,QAAQ,EAAIb,GAAG,IAAI,QALd;AAMLc,MAAAA,QAAQ,EAAId,GAAG,IAAI,QANd;AAOLe,MAAAA,OAAO,EAAKf,GAAG,IAAI,OAPd;AAQLgB,MAAAA,IAAI,EAAQhB,GAAG,IAAI,IARd;AASLT,MAAAA,SAAS,EAAGH,QAAQ,CAAC6B,aAAT,CAAuB,QAAvB,EAAiCC,UATxC;AAULC,MAAAA,QAAQ,EAAI,OAAOC,KAAP,IAAiB;AAVxB,KAAP;AAYD,GA1BG,EAfD;AA2CHC,EAAAA,QAAQ,EAAK,UAASzD,GAAT,EAAc0D,IAAd,EAAoBC,EAApB,EAAwB;AAAE3D,IAAAA,GAAG,CAACyB,gBAAJ,CAAqBiC,IAArB,EAA2BC,EAA3B,EAA+B,KAA/B;AAA2C,GA3C/E;AA4CHC,EAAAA,WAAW,EAAE,UAAS5D,GAAT,EAAc0D,IAAd,EAAoBC,EAApB,EAAwB;AAAE3D,IAAAA,GAAG,CAAC6D,mBAAJ,CAAwBH,IAAxB,EAA8BC,EAA9B,EAAkC,KAAlC;AAA2C,GA5C/E;AA8CHG,EAAAA,KAAK,EAAE,UAASH,EAAT,EAAa;AAClB,QAAIrC,IAAI,CAACC,UAAL,EAAJ,EACED,IAAI,CAACmC,QAAL,CAAcjC,QAAd,EAAwB,kBAAxB,EAA4CmC,EAA5C;AACH,GAjDE;AAmDHI,EAAAA,YAAY,EAAE,YAAW;AACvB,WAAOvC,QAAQ,CAAC6B,aAAT,CAAuB,QAAvB,CAAP;AACD,GArDE;AAuDHW,EAAAA,WAAW,EAAE,UAASC,GAAT,EAAc;AACzB,QAAI;AACF,UAAIC,CAAC,GAAG,IAAIV,KAAJ,CAAUS,GAAV,CAAR;AACAC,MAAAA,CAAC,CAACC,MAAF,GAAW,GAAX,CAFE,CAEc;;AAChB,aAAOD,CAAP;AACD,KAJD,CAIE,OAAOtB,CAAP,EAAU;AACV,aAAO,IAAP;AACD;AACF,GA/DE;AAiEHwB,EAAAA,UAAU,EAAE,UAASC,OAAT,EAAkBC,QAAlB,EAA4B;AAAE;AACxC,QAAIC,MAAM,GAAG,EAAb;AACA,QAAIC,KAAK,GAAGH,OAAO,GAAGA,OAAO,CAACI,MAAX,GAAoB,CAAvC;;AACA,QAAID,KAAK,IAAI,CAAb,EAAgB;AACdF,MAAAA,QAAQ,CAACC,MAAD,CAAR;AACD,KAFD,MAGK;AACH,WAAI,IAAIG,CAAC,GAAG,CAAZ,EAAgBA,CAAC,GAAGL,OAAO,CAACI,MAA5B,EAAqCC,CAAC,EAAtC,EAA0C;AACxC,YAAIvD,MAAM,GAAGkD,OAAO,CAACK,CAAD,CAApB;AACA,YAAIC,KAAK,GAAGnD,QAAQ,CAAC6B,aAAT,CAAuB,KAAvB,CAAZ;AACAkB,QAAAA,MAAM,CAACpD,MAAD,CAAN,GAAiBwD,KAAjB;AACArD,QAAAA,IAAI,CAACmC,QAAL,CAAckB,KAAd,EAAqB,MAArB,EAA6B,YAAW;AAAE,cAAI,EAAEH,KAAF,IAAW,CAAf,EAAkBF,QAAQ,CAACC,MAAD,CAAR;AAAmB,SAA/E;AACAI,QAAAA,KAAK,CAACV,GAAN,GAAY9C,MAAZ;AACD;AACF;AACF,GAhFE;AAkFHyD,EAAAA,MAAM,EAAE,UAASC,GAAT,EAAcC,GAAd,EAAmB;AACzB,WAAQD,GAAG,GAAIE,IAAI,CAACH,MAAL,MAAiBE,GAAG,GAAGD,GAAvB,CAAf;AACD,GApFE;AAsFHG,EAAAA,SAAS,EAAE,YAAW;AACpB,WAAO,IAAIC,IAAJ,GAAWC,OAAX,EAAP;AACD,GAxFE;AA0FHC,EAAAA,GAAG,EAAE;AACHC,IAAAA,SAAS,EAAE,CADR;AAEHC,IAAAA,GAAG,EAAQ,CAFR;AAGHC,IAAAA,MAAM,EAAI,EAHP;AAIHC,IAAAA,GAAG,EAAO,EAJP;AAKHC,IAAAA,KAAK,EAAK,EALP;AAMHC,IAAAA,IAAI,EAAM,EANP;AAOHC,IAAAA,EAAE,EAAQ,EAPP;AAQHC,IAAAA,KAAK,EAAK,EARP;AASHC,IAAAA,IAAI,EAAM,EATP;AAUHC,IAAAA,MAAM,EAAI,EAVP;AAWHC,IAAAA,IAAI,EAAM,EAXP;AAYHC,IAAAA,GAAG,EAAO,EAZP;AAaHC,IAAAA,MAAM,EAAI,EAbP;AAcHC,IAAAA,QAAQ,EAAE,EAdP;AAeHC,IAAAA,MAAM,EAAI,EAfP;AAgBHC,IAAAA,IAAI,EAAM,EAhBP;AAiBHC,IAAAA,GAAG,EAAO,EAjBP;AAkBHC,IAAAA,GAAG,EAAO,EAlBP;AAmBHC,IAAAA,CAAC,EAAS,EAnBP;AAoBHC,IAAAA,CAAC,EAAS,EApBP;AAqBHC,IAAAA,CAAC,EAAS,EArBP;AAsBHC,IAAAA,CAAC,EAAS,EAtBP;AAuBHC,IAAAA,KAAK,EAAK;AAvBP,GA1FF;AAoHH;AAEA1E,EAAAA,MAAM,EAAE;AAENhB,IAAAA,UAAU,EAAE,UAASa,EAAT,EAAaC,IAAb,EAAmBC,GAAnB,EAAwB;AAClC,WAAKA,GAAL,GAAoBrB,MAAM,CAACO,MAAP,CAAca,IAAI,CAAC6E,QAAL,IAAiB,EAA/B,EAAmC5E,GAAG,IAAI,EAA1C,CAApB,CADkC,CACiC;;AACnE,WAAK6E,GAAL,GAAoB,KAAK7E,GAAL,CAAS6E,GAAT,IAAgB,EAApC;AACA,WAAKC,QAAL,GAAoB,SAAS,KAAKD,GAAlC;AACA,WAAKE,MAAL,GAAoBtF,QAAQ,CAACuF,cAAT,CAAwBlF,EAAxB,CAApB;AACA,WAAKmF,KAAL,GAAoB,KAAKjF,GAAL,CAASiF,KAAT,IAAmB,KAAKF,MAAL,CAAYG,WAAnD;AACA,WAAKC,MAAL,GAAoB,KAAKnF,GAAL,CAASmF,MAAT,IAAmB,KAAKJ,MAAL,CAAYK,YAAnD;AACA,WAAKC,KAAL,GAAoB,KAAKN,MAAzB;AACA,WAAKM,KAAL,CAAWJ,KAAX,GAAoB,KAAKA,KAAzB;AACA,WAAKI,KAAL,CAAWF,MAAX,GAAoB,KAAKA,MAAzB;AACA,WAAKG,IAAL,GAAoB/F,IAAI,CAACyC,YAAL,EAApB;AACA,WAAKsD,IAAL,CAAUL,KAAV,GAAoB,KAAKA,KAAzB;AACA,WAAKK,IAAL,CAAUH,MAAV,GAAoB,KAAKA,MAAzB;AACA,WAAKI,OAAL,GAAoB,KAAKF,KAAL,CAAW9D,UAAX,CAAsB,IAAtB,CAApB;AACA,WAAKiE,MAAL,GAAoB,KAAKF,IAAL,CAAU/D,UAAV,CAAqB,IAArB,CAApB;AACA,WAAKkE,SAAL;AACA,WAAKC,UAAL;AAEA,WAAK3F,IAAL,GAAYpB,MAAM,CAACI,SAAP,CAAiBgB,IAAjB,EAAuB,IAAvB,EAA6B,KAAKC,GAAlC,CAAZ,CAlBkC,CAkBkB;AACrD,KArBK;AAuBNH,IAAAA,KAAK,EAAE,YAAW;AAAE;AAClB,WAAK8F,SAAL,GAAiBpG,IAAI,CAAC0D,SAAL,EAAjB;AACA,WAAK2C,KAAL,GAAiBC,WAAW,CAAC,KAAKC,IAAL,CAAU9H,IAAV,CAAe,IAAf,CAAD,EAAuB,KAAK8G,QAA5B,CAA5B;AACD,KA1BK;AA4BNiB,IAAAA,IAAI,EAAE,YAAW;AACfC,MAAAA,aAAa,CAAC,KAAKJ,KAAN,CAAb;AACD,KA9BK;AAgCNE,IAAAA,IAAI,EAAE,YAAW;AACf,UAAIjG,KAAK,GAAIN,IAAI,CAAC0D,SAAL,EAAb;AAA+B,WAAKgD,MAAL,CAAY,CAACpG,KAAK,GAAG,KAAK8F,SAAd,IAAyB,MAArC,EADhB,CAC8D;;AAC7E,UAAIO,MAAM,GAAG3G,IAAI,CAAC0D,SAAL,EAAb;AAA+B,WAAKkD,IAAL;AAC/B,UAAIC,GAAG,GAAM7G,IAAI,CAAC0D,SAAL,EAAb;AACA,WAAKoD,WAAL,CAAiBH,MAAM,GAAGrG,KAA1B,EAAiCuG,GAAG,GAAGF,MAAvC;AACA,WAAKP,SAAL,GAAiB9F,KAAjB;AACD,KAtCK;AAwCNoG,IAAAA,MAAM,EAAE,UAASK,EAAT,EAAa;AACnB,WAAKvG,IAAL,CAAUkG,MAAV,CAAiBK,EAAjB;AACD,KA1CK;AA4CNH,IAAAA,IAAI,EAAE,YAAW;AACf,WAAKX,MAAL,CAAYe,SAAZ,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,KAAKtB,KAAjC,EAAwC,KAAKE,MAA7C;AACA,WAAKpF,IAAL,CAAUoG,IAAV,CAAe,KAAKX,MAApB;AACA,WAAKgB,SAAL,CAAe,KAAKhB,MAApB;AACA,WAAKD,OAAL,CAAagB,SAAb,CAAuB,CAAvB,EAA0B,CAA1B,EAA6B,KAAKtB,KAAlC,EAAyC,KAAKE,MAA9C;AACA,WAAKI,OAAL,CAAakB,SAAb,CAAuB,KAAKnB,IAA5B,EAAkC,CAAlC,EAAqC,CAArC;AACD,KAlDK;AAoDNI,IAAAA,UAAU,EAAE,YAAW;AACrB,WAAKgB,KAAL,GAAa;AACXjE,QAAAA,KAAK,EAAG,CADG;AAEXoC,QAAAA,GAAG,EAAK,CAFG;AAGXoB,QAAAA,MAAM,EAAE,CAHG;AAIXE,QAAAA,IAAI,EAAI,CAJG;AAKXQ,QAAAA,KAAK,EAAG,CALG,CAKA;;AALA,OAAb;AAOD,KA5DK;AA8DNN,IAAAA,WAAW,EAAE,UAASJ,MAAT,EAAiBE,IAAjB,EAAuB;AAClC,UAAI,KAAKnG,GAAL,CAAS0G,KAAb,EAAoB;AAClB,aAAKA,KAAL,CAAWT,MAAX,GAAoBjD,IAAI,CAACD,GAAL,CAAS,CAAT,EAAYkD,MAAZ,CAApB;AACA,aAAKS,KAAL,CAAWP,IAAX,GAAoBnD,IAAI,CAACD,GAAL,CAAS,CAAT,EAAYoD,IAAZ,CAApB;AACA,aAAKO,KAAL,CAAWC,KAAX,GAAoB,KAAKD,KAAL,CAAWT,MAAX,GAAoB,KAAKS,KAAL,CAAWP,IAAnD;AACA,aAAKO,KAAL,CAAWjE,KAAX,GAAoB,KAAKiE,KAAL,CAAWjE,KAAX,IAAoB,KAAKoC,GAAzB,GAA+B,CAA/B,GAAmC,KAAK6B,KAAL,CAAWjE,KAAX,GAAmB,CAA1E;AACA,aAAKiE,KAAL,CAAW7B,GAAX,GAAoB7B,IAAI,CAACF,GAAL,CAAS,KAAK+B,GAAd,EAAmB,OAAO,KAAK6B,KAAL,CAAWC,KAArC,CAApB;AACD;AACF,KAtEK;AAwENH,IAAAA,SAAS,EAAE,UAASI,GAAT,EAAc;AACvB,UAAI,KAAK5G,GAAL,CAAS0G,KAAb,EAAoB;AAClBE,QAAAA,GAAG,CAACC,QAAJ,CAAa,YAAa,KAAKH,KAAL,CAAWjE,KAArC,EAAoD,KAAKwC,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACAyB,QAAAA,GAAG,CAACC,QAAJ,CAAa,UAAa,KAAKH,KAAL,CAAW7B,GAArC,EAAoD,KAAKI,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACAyB,QAAAA,GAAG,CAACC,QAAJ,CAAa,aAAa,KAAKH,KAAL,CAAWT,MAAxB,GAAiC,IAA9C,EAAoD,KAAKhB,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACAyB,QAAAA,GAAG,CAACC,QAAJ,CAAa,WAAa,KAAKH,KAAL,CAAWP,IAAxB,GAAiC,IAA9C,EAAoD,KAAKlB,KAAL,GAAa,GAAjE,EAAsE,KAAKE,MAAL,GAAc,EAApF;AACD;AACF,KA/EK;AAiFNM,IAAAA,SAAS,EAAE,YAAW;AACpBlG,MAAAA,IAAI,CAACmC,QAAL,CAAcjC,QAAd,EAAwB,SAAxB,EAAmC,KAAKqH,SAAL,CAAe9I,IAAf,CAAoB,IAApB,CAAnC;AACAuB,MAAAA,IAAI,CAACmC,QAAL,CAAcjC,QAAd,EAAwB,OAAxB,EAAmC,KAAKsH,OAAL,CAAa/I,IAAb,CAAkB,IAAlB,CAAnC;AACD,KApFK;AAsFN8I,IAAAA,SAAS,EAAE,UAASE,EAAT,EAAa;AAAE,UAAI,KAAKjH,IAAL,CAAU+G,SAAd,EAAyB,KAAK/G,IAAL,CAAU+G,SAAV,CAAoBE,EAAE,CAACC,OAAvB;AAAkC,KAtF/E;AAuFNF,IAAAA,OAAO,EAAI,UAASC,EAAT,EAAa;AAAE,UAAI,KAAKjH,IAAL,CAAUgH,OAAd,EAAyB,KAAKhH,IAAL,CAAUgH,OAAV,CAAkBC,EAAE,CAACC,OAArB;AAAkC,KAvF/E;AAyFNC,IAAAA,UAAU,EAAE,YAAW;AAAE,WAAKnC,MAAL,CAAYoC,KAAZ,CAAkBC,MAAlB,GAA2B,MAA3B;AAAoC,KAzFvD;AA0FNC,IAAAA,UAAU,EAAE,YAAW;AAAE,WAAKtC,MAAL,CAAYoC,KAAZ,CAAkBC,MAAlB,GAA2B,MAA3B;AAAoC,KA1FvD;AA4FNE,IAAAA,KAAK,EAAE,UAASC,GAAT,EAAc;AACnB,WAAKxB,IAAL,GADmB,CACN;;AACbyB,MAAAA,MAAM,GAAGC,MAAM,CAACH,KAAP,CAAaC,GAAb,CAAT;AACA,WAAK1H,KAAL;AACA,aAAO2H,MAAP;AACD,KAjGK;AAmGNE,IAAAA,OAAO,EAAE,UAASH,GAAT,EAAc;AACrB,WAAKxB,IAAL,GADqB,CACR;;AACbyB,MAAAA,MAAM,GAAGC,MAAM,CAACC,OAAP,CAAeH,GAAf,CAAT;AACA,WAAK1H,KAAL;AACA,aAAO2H,MAAP;AACD,KAxGK,CA0GN;;AA1GM,GAtHL,CAkOD;;AAlOC,CAAP,C,CAmOI","sourcesContent":["//=============================================================================\n//\n// We need some ECMAScript 5 methods but we need to implement them ourselves\n// for older browsers (compatibility: http://kangax.github.com/es5-compat-table/)\n//\n//  Function.bind:        https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind\n//  Object.create:        http://javascript.crockford.com/prototypal.html\n//  Object.extend:        (defacto standard like jquery $.extend or prototype's Object.extend)\n//\n//  Object.construct:     our own wrapper around Object.create that ALSO calls\n//                        an initialize constructor method if one exists\n//\n//=============================================================================\n\nif (!Function.prototype.bind) {\n    Function.prototype.bind = function(obj) {\n      var slice = [].slice,\n          args  = slice.call(arguments, 1),\n          self  = this,\n          nop   = function () {},\n          bound = function () {\n            return self.apply(this instanceof nop ? this : (obj || {}), args.concat(slice.call(arguments)));   \n          };\n      nop.prototype   = self.prototype;\n      bound.prototype = new nop();\n      return bound;\n    };\n  }\n  \n  if (!Object.create) {\n    Object.create = function(base) {\n      function F() {};\n      F.prototype = base;\n      return new F();\n    }\n  }\n  \n  if (!Object.construct) {\n    Object.construct = function(base) {\n      var instance = Object.create(base);\n      if (instance.initialize)\n        instance.initialize.apply(instance, [].slice.call(arguments, 1));\n      return instance;\n    }\n  }\n  \n  if (!Object.extend) {\n    Object.extend = function(destination, source) {\n      for (var property in source) {\n        if (source.hasOwnProperty(property))\n          destination[property] = source[property];\n      }\n      return destination;\n    };\n  }\n  \n  /* NOT READY FOR PRIME TIME\n  if (!window.requestAnimationFrame) {// http://paulirish.com/2011/requestanimationframe-for-smart-animating/\n    window.requestAnimationFrame = window.webkitRequestAnimationFrame || \n                                   window.mozRequestAnimationFrame    || \n                                   window.oRequestAnimationFrame      || \n                                   window.msRequestAnimationFrame     || \n                                   function(callback, element) {\n                                     window.setTimeout(callback, 1000 / 60);\n                                   }\n  }\n  */\n  \n  //=============================================================================\n  // GAME\n  //=============================================================================\n  \nGame = {\n  \n    compatible: function() {\n      return Object.create &&\n             Object.extend &&\n             Function.bind &&\n             document.addEventListener && // HTML5 standard, all modern browsers that support canvas should also support add/removeEventListener\n             Game.ua.hasCanvas\n    },\n  \n    start: function(id, game, cfg) {\n      if (Game.compatible())\n        return Object.construct(Game.Runner, id, game, cfg).game; // return the game instance, not the runner (caller can always get at the runner via game.runner)\n    },\n  \n    ua: function() { // should avoid user agent sniffing... but sometimes you just gotta do what you gotta do\n      var ua  = navigator.userAgent.toLowerCase();\n      var key =        ((ua.indexOf(\"opera\")   > -1) ? \"opera\"   : null);\n          key = key || ((ua.indexOf(\"firefox\") > -1) ? \"firefox\" : null);\n          key = key || ((ua.indexOf(\"chrome\")  > -1) ? \"chrome\"  : null);\n          key = key || ((ua.indexOf(\"safari\")  > -1) ? \"safari\"  : null);\n          key = key || ((ua.indexOf(\"msie\")    > -1) ? \"ie\"      : null);\n  \n      try {\n        var re      = (key == \"ie\") ? \"msie (\\\\d)\" : key + \"\\\\/(\\\\d\\\\.\\\\d)\"\n        var matches = ua.match(new RegExp(re, \"i\"));\n        var version = matches ? parseFloat(matches[1]) : null;\n      } catch (e) {}\n  \n      return {\n        full:      ua, \n        name:      key + (version ? \" \" + version.toString() : \"\"),\n        version:   version,\n        isFirefox: (key == \"firefox\"),\n        isChrome:  (key == \"chrome\"),\n        isSafari:  (key == \"safari\"),\n        isOpera:   (key == \"opera\"),\n        isIE:      (key == \"ie\"),\n        hasCanvas: (document.createElement('canvas').getContext),\n        hasAudio:  (typeof(Audio) != 'undefined')\n      }\n    }(),\n  \n    addEvent:    function(obj, type, fn) { obj.addEventListener(type, fn, false);    },\n    removeEvent: function(obj, type, fn) { obj.removeEventListener(type, fn, false); },\n  \n    ready: function(fn) {\n      if (Game.compatible())\n        Game.addEvent(document, 'DOMContentLoaded', fn);\n    },\n  \n    createCanvas: function() {\n      return document.createElement('canvas');\n    },\n  \n    createAudio: function(src) {\n      try {\n        var a = new Audio(src);\n        a.volume = 0.1; // lets be real quiet please\n        return a;\n      } catch (e) {\n        return null;\n      }\n    },\n  \n    loadImages: function(sources, callback) { /* load multiple images and callback when ALL have finished loading */\n      var images = {};\n      var count = sources ? sources.length : 0;\n      if (count == 0) {\n        callback(images);\n      }\n      else {\n        for(var n = 0 ; n < sources.length ; n++) {\n          var source = sources[n];\n          var image = document.createElement('img');\n          images[source] = image;\n          Game.addEvent(image, 'load', function() { if (--count == 0) callback(images); });\n          image.src = source;\n        }\n      }\n    },\n  \n    random: function(min, max) {\n      return (min + (Math.random() * (max - min)));\n    },\n  \n    timestamp: function() { \n      return new Date().getTime();\n    },\n  \n    KEY: {\n      BACKSPACE: 8,\n      TAB:       9,\n      RETURN:   13,\n      ESC:      27,\n      SPACE:    32,\n      LEFT:     37,\n      UP:       38,\n      RIGHT:    39,\n      DOWN:     40,\n      DELETE:   46,\n      HOME:     36,\n      END:      35,\n      PAGEUP:   33,\n      PAGEDOWN: 34,\n      INSERT:   45,\n      ZERO:     48,\n      ONE:      49,\n      TWO:      50,\n      A:        65,\n      L:        76,\n      P:        80,\n      Q:        81,\n      TILDA:    192\n    },\n  \n    //-----------------------------------------------------------------------------\n  \n    Runner: {\n  \n      initialize: function(id, game, cfg) {\n        this.cfg          = Object.extend(game.Defaults || {}, cfg || {}); // use game defaults (if any) and extend with custom cfg (if any)\n        this.fps          = this.cfg.fps || 60;\n        this.interval     = 1000.0 / this.fps;\n        this.canvas       = document.getElementById(id);\n        this.width        = this.cfg.width  || this.canvas.offsetWidth;\n        this.height       = this.cfg.height || this.canvas.offsetHeight;\n        this.front        = this.canvas;\n        this.front.width  = this.width;\n        this.front.height = this.height;\n        this.back         = Game.createCanvas();\n        this.back.width   = this.width;\n        this.back.height  = this.height;\n        this.front2d      = this.front.getContext('2d');\n        this.back2d       = this.back.getContext('2d');\n        this.addEvents();\n        this.resetStats();\n  \n        this.game = Object.construct(game, this, this.cfg); // finally construct the game object itself\n      },\n  \n      start: function() { // game instance should call runner.start() when its finished initializing and is ready to start the game loop\n        this.lastFrame = Game.timestamp();\n        this.timer     = setInterval(this.loop.bind(this), this.interval);\n      },\n  \n      stop: function() {\n        clearInterval(this.timer);\n      },\n  \n      loop: function() {\n        var start  = Game.timestamp(); this.update((start - this.lastFrame)/1000.0); // send dt as seconds\n        var middle = Game.timestamp(); this.draw();\n        var end    = Game.timestamp();\n        this.updateStats(middle - start, end - middle);\n        this.lastFrame = start;\n      },\n  \n      update: function(dt) {\n        this.game.update(dt);\n      },\n  \n      draw: function() {\n        this.back2d.clearRect(0, 0, this.width, this.height);\n        this.game.draw(this.back2d);\n        this.drawStats(this.back2d);\n        this.front2d.clearRect(0, 0, this.width, this.height);\n        this.front2d.drawImage(this.back, 0, 0);\n      },\n  \n      resetStats: function() {\n        this.stats = {\n          count:  0,\n          fps:    0,\n          update: 0,\n          draw:   0, \n          frame:  0  // update + draw\n        };\n      },\n  \n      updateStats: function(update, draw) {\n        if (this.cfg.stats) {\n          this.stats.update = Math.max(1, update);\n          this.stats.draw   = Math.max(1, draw);\n          this.stats.frame  = this.stats.update + this.stats.draw;\n          this.stats.count  = this.stats.count == this.fps ? 0 : this.stats.count + 1;\n          this.stats.fps    = Math.min(this.fps, 1000 / this.stats.frame);\n        }\n      },\n  \n      drawStats: function(ctx) {\n        if (this.cfg.stats) {\n          ctx.fillText(\"frame: \"  + this.stats.count,         this.width - 100, this.height - 60);\n          ctx.fillText(\"fps: \"    + this.stats.fps,           this.width - 100, this.height - 50);\n          ctx.fillText(\"update: \" + this.stats.update + \"ms\", this.width - 100, this.height - 40);\n          ctx.fillText(\"draw: \"   + this.stats.draw   + \"ms\", this.width - 100, this.height - 30);\n        }\n      },\n  \n      addEvents: function() {\n        Game.addEvent(document, 'keydown', this.onkeydown.bind(this));\n        Game.addEvent(document, 'keyup',   this.onkeyup.bind(this));\n      },\n  \n      onkeydown: function(ev) { if (this.game.onkeydown) this.game.onkeydown(ev.keyCode); },\n      onkeyup:   function(ev) { if (this.game.onkeyup)   this.game.onkeyup(ev.keyCode);   },\n  \n      hideCursor: function() { this.canvas.style.cursor = 'none'; },\n      showCursor: function() { this.canvas.style.cursor = 'auto'; },\n  \n      alert: function(msg) {\n        this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n        result = window.alert(msg);\n        this.start();\n        return result;\n      },\n  \n      confirm: function(msg) {\n        this.stop(); // alert blocks thread, so need to stop game loop in order to avoid sending huge dt values to next update\n        result = window.confirm(msg);\n        this.start();\n        return result;\n      }\n  \n      //-------------------------------------------------------------------------\n  \n    } // Game.Runner\n  } // Game"]},"metadata":{},"sourceType":"module"}