{"ast":null,"code":"class Vec {\n  constructor(x = 0, y = 0) {\n    this.x = x;\n    this.y = y;\n  }\n\n  get len() {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n\n  set len(value) {\n    const fact = value / this.len;\n    this.x *= fact;\n    this.y *= fact;\n  }\n\n}\n\nclass Rect {\n  constructor(w, h) {\n    this.pos = new Vec();\n    this.size = new Vec(w, h);\n  }\n\n  get left() {\n    return this.pos.x;\n  }\n\n  get right() {\n    return this.pos.x + this.size.x;\n  }\n\n  get top() {\n    return this.pos.y;\n  }\n\n  get bottom() {\n    return this.pos.y + this.size.y;\n  }\n\n}\n\nclass Ball extends Rect {\n  constructor() {\n    super(10, 10);\n    this.vel = new Vec();\n  }\n\n}\n\nclass Player extends Rect {\n  constructor() {\n    super(20, 100);\n    this.score = 0;\n  }\n\n}\n\nclass Pong {\n  constructor(canvas) {\n    this._canvas = canvas;\n    this._context = this._canvas.getContext('2d');\n    this.ball = new Ball();\n    this.ball.pos.x = 100;\n    this.ball.pos.y = 100;\n    this.ball.vel.x = 400;\n    this.ball.vel.y = 400;\n    this.players = [new Player(), new Player()];\n    this.players[0].pos.x = 40;\n    this.players[1].pos.x = this._canvas.width - 40;\n    this.players[0].pos.y = 100;\n    let lastTime;\n\n    const callback = millis => {\n      if (lastTime) {\n        this.update((millis - lastTime) / 1000);\n      }\n\n      lastTime = millis;\n      requestAnimationFrame(callback);\n    };\n\n    callback();\n  }\n\n  collide(player, ball) {\n    if (player.left < ball.right && player.right > ball.left && player.top < ball.bottom && player.bottom > ball.top) {\n      ball.vel.x = -ball.vel.x;\n      ball.vel.y += 300 * (Math.random() - .5);\n      ball.vel.len *= 1.05;\n    }\n  }\n\n  reset() {\n    this.ball.pos.x = this._canvas.width / 2;\n    this.ball.pos.y = this._canvas.height / 2;\n    this.ball.vel.x = 0;\n    this.ball.vel.y = 0;\n  }\n\n  start() {\n    if (this.ball.vel.x === 0 && this.ball.vel.y === 0) {\n      this.ball.vel.x = 300 * (Math.random() > .5 ? 1 : -1);\n      this.ball.vel.y = 300 * (Math.random() * 2 - 1);\n      this.ball.vel.len = 400;\n    }\n  }\n\n  draw() {\n    this._context.fillStyle = \"black\";\n\n    this._context.fillRect(0, 0, this._canvas.width, this._canvas.height);\n\n    this._context.fillStyle = 'white';\n\n    this._context.fillRect(this.ball.pos.x, this.ball.pos.y, this.ball.size.x, this.ball.size.y);\n\n    this.players.forEach(player => this.drawRect(player));\n    this.players.forEach((player, index) => this.drawScore(player.score, index));\n  }\n\n  drawScore(scores, index) {\n    const align = this._canvas.width / 3;\n    this._context.fillStyle = \"white\";\n    this._context.font = '50px serif';\n\n    this._context.fillText(scores, align * (index + 1), 100);\n  }\n\n  drawRect(rect) {\n    this._context.fillStyle = \"white\";\n\n    this._context.fillRect(rect.pos.x, rect.pos.y, rect.size.x, rect.size.y);\n  }\n\n  update(dt) {\n    this.ball.pos.x += this.ball.vel.x * dt;\n    this.ball.pos.y += this.ball.vel.y * dt;\n\n    if (this.ball.left < 0 || this.ball.right > this._canvas.width) {\n      let playerId = this.ball.vel.x < 0 | 0;\n      this.players[playerId].score++;\n      this.reset();\n    }\n\n    if (this.ball.top < 0 || this.ball.bottom > this._canvas.height) {\n      this.ball.vel.y = -this.ball.vel.y;\n    } // this.players[1].pos.y = this.ball.pos.y;\n\n\n    this.players.forEach(player => this.collide(player, this.ball));\n    this.draw();\n  }\n\n} // const canvas = document.getElementById('pong');\n// const context = canvas.getContext('2d');\n// const pong = new Pong(canvas);","map":{"version":3,"sources":["/Users/art/Desktop/transcendence/transcendence/transcendence/src/game/game.js"],"names":["Vec","constructor","x","y","len","Math","sqrt","value","fact","Rect","w","h","pos","size","left","right","top","bottom","Ball","vel","Player","score","Pong","canvas","_canvas","_context","getContext","ball","players","width","lastTime","callback","millis","update","requestAnimationFrame","collide","player","random","reset","height","start","draw","fillStyle","fillRect","forEach","drawRect","index","drawScore","scores","align","font","fillText","rect","dt","playerId"],"mappings":"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","sourcesContent":["class Vec {\n  constructor(x = 0, y = 0)\n  {\n    this.x = x;\n    this.y = y;\n  }\n  get len()\n  {\n    return Math.sqrt(this.x * this.x + this.y * this.y);\n  }\n  set len(value)\n  {\n    const fact = value / this.len;\n    this.x *= fact;\n    this.y *= fact;\n  }\n}\n\nclass Rect {\n  constructor(w,h)\n  {\n    this.pos = new Vec;\n    this.size = new Vec(w, h);\n  }\n  get left()\n  {\n    return this.pos.x;\n  }\n  get right()\n  {\n    return this.pos.x + this.size.x;\n  }\n  get top()\n  {\n    return this.pos.y;\n  }\n  get bottom()\n  {\n    return this.pos.y + this.size.y;\n  }\n}\n\nclass Ball extends Rect {\n  constructor()\n  {\n    super(10,10);\n    this.vel = new Vec;\n  }\n}\n\nclass Player extends Rect {\n  constructor()\n  {\n    super(20,100);\n    this.score = 0;\n  }\n}\n\n\n\nclass Pong {\n  constructor(canvas)\n  {\n    this._canvas = canvas;\n    this._context = this._canvas.getContext('2d');\n    this.ball = new Ball;\n    this.ball.pos.x = 100;\n    this.ball.pos.y = 100;\n    this.ball.vel.x = 400;\n    this.ball.vel.y = 400;\n\n    this.players = [\n      new Player,\n      new Player,\n    ]\n\n    this.players[0].pos.x = 40;\n    this.players[1].pos.x = this._canvas.width - 40;\n    this.players[0].pos.y = 100;\n    let lastTime;\n\n    const callback = (millis) => {\n      if (lastTime) {\n        this.update((millis - lastTime) / 1000);\n      }\n      lastTime = millis;\n      requestAnimationFrame(callback);\n  };\n    callback();\n  }\n  collide(player, ball)\n  {\n    if (player.left < ball.right && player.right > ball.left &&\n        player.top < ball.bottom && player.bottom > ball.top)\n        {\n          ball.vel.x = -ball.vel.x;\n          ball.vel.y += 300 * (Math.random() - .5); \n          ball.vel.len *= 1.05;\n        }\n  }\n  \n  reset()\n  {\n    this.ball.pos.x = this._canvas.width / 2;\n    this.ball.pos.y = this._canvas.height / 2;\n    this.ball.vel.x = 0;\n    this.ball.vel.y = 0;\n  }\n  start()\n  {\n    if (this.ball.vel.x === 0 && this.ball.vel.y === 0) {\n      this.ball.vel.x = 300 * (Math.random() > .5 ? 1 : -1);\n      this.ball.vel.y = 300 * (Math.random() * 2  -1);\n      this.ball.vel.len = 400;\n\n    }\n  }\n  draw()\n  {\n    this._context.fillStyle = \"black\";\n    this._context.fillRect(0,0, \n                            this._canvas.width, this._canvas.height);\n    this._context.fillStyle = 'white';\n    this._context.fillRect(this.ball.pos.x, this.ball.pos.y, this.ball.size.x, this.ball.size.y);\n    this.players.forEach(player => this.drawRect(player));\n    this.players.forEach((player, index) => this.drawScore(player.score, index));\n  }\n  drawScore(scores, index)\n  {\n    const align = this._canvas.width / 3;\n\n    this._context.fillStyle = \"white\"; \n    this._context.font = '50px serif';\n    this._context.fillText(scores, align * (index + 1), 100);\n  }\n  drawRect(rect)\n  {\n    this._context.fillStyle = \"white\";\n    this._context.fillRect(rect.pos.x, rect.pos.y, \n                            rect.size.x, rect.size.y);\n\n  }\n  update(dt) {\n    this.ball.pos.x += this.ball.vel.x * dt;\n    this.ball.pos.y += this.ball.vel.y * dt;\n  \n    if (this.ball.left < 0 || this.ball.right > this._canvas.width)\n    {\n      let playerId = this.ball.vel.x < 0 | 0;\n      this.players[playerId].score++;\n      this.reset();\n    }\n    if (this.ball.top < 0 || this.ball.bottom > this._canvas.height)\n    {\n      this.ball.vel.y = -this.ball.vel.y;\n    } \n\n    // this.players[1].pos.y = this.ball.pos.y;\n    this.players.forEach(player => this.collide(player, this.ball));\n    this.draw(); \n  }\n}\n\n// const canvas = document.getElementById('pong');\n// const context = canvas.getContext('2d');\n// const pong = new Pong(canvas);\n\n\n\n\n\n\n"]},"metadata":{},"sourceType":"module"}